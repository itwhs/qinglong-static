(self.webpackChunk=self.webpackChunk||[]).push([[7953,578],{56996:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"},h=o,D=e(17536),l=function(c,B){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:B,icon:h}))};l.displayName="ClockCircleOutlined";var s=r.forwardRef(l)},5962:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},h=o,D=e(17536),l=function(c,B){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:B,icon:h}))};l.displayName="DeleteOutlined";var s=r.forwardRef(l)},62198:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},h=o,D=e(17536),l=function(c,B){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:B,icon:h}))};l.displayName="FileTextOutlined";var s=r.forwardRef(l)},35316:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 1024c-69.1 0-136.2-13.5-199.3-40.2C251.7 958 197 921 150 874c-47-47-84-101.7-109.8-162.7C13.5 648.2 0 581.1 0 512c0-19.9 16.1-36 36-36s36 16.1 36 36c0 59.4 11.6 117 34.6 171.3 22.2 52.4 53.9 99.5 94.3 139.9 40.4 40.4 87.5 72.2 139.9 94.3C395 940.4 452.6 952 512 952c59.4 0 117-11.6 171.3-34.6 52.4-22.2 99.5-53.9 139.9-94.3 40.4-40.4 72.2-87.5 94.3-139.9C940.4 629 952 571.4 952 512c0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.2C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3s-13.5 136.2-40.2 199.3C958 772.3 921 827 874 874c-47 47-101.8 83.9-162.7 109.7-63.1 26.8-130.2 40.3-199.3 40.3z"}}]},name:"loading-3-quarters",theme:"outlined"},h=o,D=e(17536),l=function(c,B){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:B,icon:h}))};l.displayName="Loading3QuartersOutlined";var s=r.forwardRef(l)},22932:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},h=o,D=e(17536),l=function(c,B){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:B,icon:h}))};l.displayName="PauseCircleOutlined";var s=r.forwardRef(l)},66260:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},h=o,D=e(17536),l=function(c,B){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:B,icon:h}))};l.displayName="PlayCircleOutlined";var s=r.forwardRef(l)},85451:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},h=o,D=e(17536),l=function(c,B){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:B,icon:h}))};l.displayName="StopOutlined";var s=r.forwardRef(l)},99071:function(v,f,e){"use strict";var d=e(46686),r=e.n(d),o=e(63313),h=e.n(o),D=e(61761),l=e(48388);f.Z=function(s,P){var c=(0,o.useState)(),B=r()(c,2),ee=B[0],p=B[1];return(0,D.Z)(s,function(A){var F=A.target;F.classList.contains("ant-table-wrapper")||(F=A.target.querySelector(".ant-table-wrapper")),p((0,l.W9)({extraHeight:P,target:F}))}),ee}},32479:function(v,f,e){"use strict";e.r(f),e.d(f,{IntervalSchedule:function(){return K},SubscriptionStatus:function(){return g},SubscriptionType:function(){return Y},default:function(){return oe}});var d=e(94434),r=e.n(d),o=e(46686),h=e.n(o),D=e(30279),l=e.n(D),s=e(63313),P=e(87670),c=e(30314),B=e(96384),ee=e(65646),p=e(61135),A=e(4352),F=e(63533),De=e(22999),k=e(15051),b=e(59225),Ee=e(61685),ae=e(56996),le=e(35316),ce=e(74761),t=e(66260),G=e(22932),ve=e(62198),re=e(97947),Ce=e(9734),_e=e(85451),J=e(5962),y=e(59140),z=e(41601),X=e(11168),Q=e(73835),ge=e(62531),Z=e(65731),fe=e(21305),he=e(99071),a=e(11527),V=P.Z.Text,ie=P.Z.Paragraph,pe=c.Z.Search,g;(function(C){C[C.running=0]="running",C[C.idle=1]="idle",C[C.disabled=2]="disabled",C[C.queued=3]="queued"})(g||(g={}));var K;(function(C){C.days="\u5929",C.hours="\u65F6",C.minutes="\u5206",C.seconds="\u79D2"})(K||(K={}));var Y;(function(C){C["private-repo"]="\u79C1\u6709\u4ED3\u5E93",C["public-repo"]="\u516C\u5F00\u4ED3\u5E93",C.file="\u5355\u6587\u4EF6"})(Y||(Y={}));var me=function(){var xe=(0,Z.bx)(),Be=xe.headerStyle,Oe=xe.isPhone,te=xe.socketMessage,Te=[{title:"\u540D\u79F0",dataIndex:"name",key:"name",width:150,align:"center",sorter:{compare:function(n,u){return n.name.localeCompare(u.name)},multiple:2}},{title:"\u94FE\u63A5",dataIndex:"url",key:"url",align:"center",sorter:{compare:function(n,u){return n.name.localeCompare(u.name)},multiple:2},render:function(n,u){return(0,a.jsx)(ie,{style:{wordBreak:"break-all",marginBottom:0,textAlign:"left"},ellipsis:{tooltip:n,rows:2},children:n})}},{title:"\u7C7B\u578B",dataIndex:"type",key:"type",width:130,align:"center",render:function(n,u){return Y[u.type]}},{title:"\u5206\u652F",dataIndex:"branch",key:"branch",width:130,align:"center",render:function(n,u){return u.branch||"-"}},{title:"\u5B9A\u65F6\u89C4\u5219",width:180,align:"center",render:function(n,u){if(u.schedule_type==="interval"){var m=u.interval_schedule,O=m.type,S=m.value;return"\u6BCF".concat(S).concat(K[O])}return u.schedule}},{title:"\u72B6\u6001",key:"status",dataIndex:"status",align:"center",width:110,filters:[{text:"\u8FD0\u884C\u4E2D",value:0},{text:"\u7A7A\u95F2\u4E2D",value:1},{text:"\u5DF2\u7981\u7528",value:2}],onFilter:function(n,u){return u.is_disabled&&u.status!==0?n===2:u.status===n},render:function(n,u){return(0,a.jsxs)(a.Fragment,{children:[(!u.is_disabled||u.status!==g.idle)&&(0,a.jsxs)(a.Fragment,{children:[u.status===g.idle&&(0,a.jsx)(B.Z,{icon:(0,a.jsx)(ae.Z,{}),color:"default",children:"\u7A7A\u95F2\u4E2D"}),u.status===g.running&&(0,a.jsx)(B.Z,{icon:(0,a.jsx)(le.Z,{spin:!0}),color:"processing",children:"\u8FD0\u884C\u4E2D"})]}),u.is_disabled===1&&u.status===g.idle&&(0,a.jsx)(B.Z,{icon:(0,a.jsx)(ce.Z,{}),color:"error",children:"\u5DF2\u7981\u7528"})]})}},{title:"\u64CD\u4F5C",key:"action",align:"center",width:130,render:function(n,u,m){var O=!Oe;return(0,a.jsxs)(ee.Z,{size:"middle",children:[u.status===g.idle&&(0,a.jsx)(p.Z,{title:O?"\u8FD0\u884C":"",children:(0,a.jsx)("a",{onClick:function(U){U.stopPropagation(),Ge(u,m)},children:(0,a.jsx)(t.Z,{})})}),u.status!==g.idle&&(0,a.jsx)(p.Z,{title:O?"\u505C\u6B62":"",children:(0,a.jsx)("a",{onClick:function(U){U.stopPropagation(),Je(u,m)},children:(0,a.jsx)(G.Z,{})})}),(0,a.jsx)(p.Z,{title:O?"\u65E5\u5FD7":"",children:(0,a.jsx)("a",{onClick:function(U){U.stopPropagation(),we(l()(l()({},u),{},{timestamp:Date.now()}))},children:(0,a.jsx)(ve.Z,{})})}),(0,a.jsx)(tt,{record:u,index:m},"more")]})}}],Ie=(0,s.useState)([]),Pe=h()(Ie,2),W=Pe[0],H=Pe[1],Se=(0,s.useState)(!0),se=h()(Se,2),be=se[0],Ae=se[1],ye=(0,s.useState)(!1),je=h()(ye,2),j=je[0],i=je[1],x=(0,s.useState)(),E=h()(x,2),I=E[0],L=E[1],$=(0,s.useState)(""),N=h()($,2),de=N[0],M=N[1],ne=(0,s.useState)(1),ue=h()(ne,2),Fe=ue[0],Ze=ue[1],Le=(0,s.useState)(20),q=h()(Le,2),Qe=q[0],Re=q[1],Ve=(0,s.useState)(!1),We=h()(Ve,2),He=We[0],Ue=We[1],Ne=(0,s.useState)(),Ke=h()(Ne,2),Me=Ke[0],we=Ke[1],ze=(0,s.useRef)(),ke=(0,he.Z)(ze),Ge=function(n,u){A.Z.confirm({title:"\u786E\u8BA4\u8FD0\u884C",content:(0,a.jsxs)(a.Fragment,{children:["\u786E\u8BA4\u8FD0\u884C\u5B9A\u65F6\u4EFB\u52A1"," ",(0,a.jsx)(V,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){Q.W.put("".concat(z.Z.apiPrefix,"subscriptions/run"),{data:[n.id]}).then(function(O){var S=O.code,U=O.data;if(S===200){var T=r()(W),R=T.findIndex(function(w){return w.id===n.id});R!==-1&&(T.splice(R,1,l()(l()({},n),{},{status:g.running})),H(T))}})},onCancel:function(){console.log("Cancel")}})},Je=function(n,u){A.Z.confirm({title:"\u786E\u8BA4\u505C\u6B62",content:(0,a.jsxs)(a.Fragment,{children:["\u786E\u8BA4\u505C\u6B62\u5B9A\u65F6\u4EFB\u52A1"," ",(0,a.jsx)(V,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){Q.W.put("".concat(z.Z.apiPrefix,"subscriptions/stop"),{data:[n.id]}).then(function(O){var S=O.code,U=O.data;if(S===200){var T=r()(W),R=T.findIndex(function(w){return w.id===n.id});R!==-1&&(T.splice(R,1,l()(l()({},n),{},{pid:null,status:g.idle})),H(T))}})},onCancel:function(){console.log("Cancel")}})},Xe=function(){Ae(!0),Q.W.get("".concat(z.Z.apiPrefix,"subscriptions?searchValue=").concat(de)).then(function(n){var u=n.code,m=n.data;u===200&&(H(m),Ze(1))}).finally(function(){return Ae(!1)})},Ye=function(){L(null),i(!0)},$e=function(n,u){L(n),i(!0)},qe=function(n,u){A.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:(0,a.jsxs)(a.Fragment,{children:["\u786E\u8BA4\u5220\u9664\u5B9A\u65F6\u8BA2\u9605"," ",(0,a.jsx)(V,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){Q.W.delete("".concat(z.Z.apiPrefix,"subscriptions"),{data:[n.id]}).then(function(O){var S=O.code,U=O.data;if(S===200){F.ZP.success("\u5220\u9664\u6210\u529F");var T=r()(W),R=T.findIndex(function(w){return w.id===n.id});R!==-1&&(T.splice(R,1),H(T))}})},onCancel:function(){console.log("Cancel")}})},et=function(n,u){A.Z.confirm({title:"\u786E\u8BA4".concat(n.is_disabled===1?"\u542F\u7528":"\u7981\u7528"),content:(0,a.jsxs)(a.Fragment,{children:["\u786E\u8BA4",n.is_disabled===1?"\u542F\u7528":"\u7981\u7528","\u5B9A\u65F6\u8BA2\u9605"," ",(0,a.jsx)(V,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){Q.W.put("".concat(z.Z.apiPrefix,"subscriptions/").concat(n.is_disabled===1?"enable":"disable"),{data:[n.id]}).then(function(O){var S=O.code,U=O.data;if(S===200){var T=n.is_disabled===1?0:1,R=r()(W),w=R.findIndex(function(ot){return ot.id===n.id});w!==-1&&(R.splice(w,1,l()(l()({},n),{},{is_disabled:T})),H(R))}})},onCancel:function(){console.log("Cancel")}})},tt=function(n){var u=n.record,m=n.index;return(0,a.jsx)(De.Z,{arrow:{pointAtCenter:!0},placement:"bottomRight",trigger:["click"],overlay:(0,a.jsx)(k.Z,{items:[{label:"\u7F16\u8F91",key:"edit",icon:(0,a.jsx)(re.Z,{})},{label:u.is_disabled===1?"\u542F\u7528":"\u7981\u7528",key:"enableOrDisable",icon:u.is_disabled===1?(0,a.jsx)(Ce.Z,{}):(0,a.jsx)(_e.Z,{})},{label:"\u5220\u9664",key:"delete",icon:(0,a.jsx)(J.Z,{})}],onClick:function(S){var U=S.key,T=S.domEvent;T.stopPropagation(),nt(U,u,m)}}),children:(0,a.jsx)("a",{onClick:function(S){return S.stopPropagation()},children:(0,a.jsx)(y.Z,{})})})},nt=function(n,u,m){switch(n){case"edit":$e(u,m);break;case"enableOrDisable":et(u,m);break;case"delete":qe(u,m);break;default:break}},ut=function(n){i(!1),n&&lt(n)},at=function(n){M(n.trim())},lt=function(n){var u=W.findIndex(function(O){return O.id===n.id}),m=r()(W);u===-1?m.unshift(n):m.splice(u,1,l()({},n)),H(m)},rt=function(n,u){Ze(n),Re(u),localStorage.setItem("pageSize",u+"")},it=function(n,u){return n.isPinned?"pinned-subscription subscription":"subscription"};return(0,s.useEffect)(function(){if(!!te){var _=te.type,n=te.message,u=te.references;if(_==="runSubscriptionEnd"&&u.length>0){for(var m=r()(W),O=function(T){var R=W.findIndex(function(w){return w.id===u[T]});R!==-1&&m.splice(R,1,l()(l()({},W[R]),{},{status:g.idle}))},S=0;S<u.length;S++)O(S);H(m)}}},[te]),(0,s.useEffect)(function(){Me&&(localStorage.setItem("logSubscription",Me.id),Ue(!0))},[Me]),(0,s.useEffect)(function(){Xe()},[de]),(0,s.useEffect)(function(){Re(parseInt(localStorage.getItem("pageSize")||"20"))},[]),(0,a.jsxs)(X.ZP,{className:"ql-container-wrapper subscriptiontab-wrapper",title:"\u8BA2\u9605\u7BA1\u7406",extra:[(0,a.jsx)(pe,{placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0\u6216\u8005\u5173\u952E\u8BCD",style:{width:"auto"},enterButton:!0,allowClear:!0,loading:be,onSearch:at}),(0,a.jsx)(b.Z,{type:"primary",onClick:function(){return Ye()},children:"\u65B0\u5EFA\u8BA2\u9605"},"2")],header:{style:Be},children:[(0,a.jsx)(Ee.Z,{ref:ze,columns:Te,pagination:{current:Fe,onChange:rt,pageSize:Qe,showSizeChanger:!0,simple:Oe,defaultPageSize:20,showTotal:function(n,u){return"\u7B2C ".concat(u[0],"-").concat(u[1]," \u6761/\u603B\u5171 ").concat(n," \u6761")},pageSizeOptions:[20,100,500,1e3]},dataSource:W,rowKey:"id",size:"middle",scroll:{x:1e3,y:ke},loading:be,rowClassName:it}),(0,a.jsx)(ge.default,{visible:j,handleCancel:ut,subscription:I}),(0,a.jsx)(fe.default,{visible:He,handleCancel:function(){Ue(!1)},subscription:Me})]})},oe=me},21305:function(v,f,e){"use strict";e.r(f);var d=e(46686),r=e.n(d),o=e(63313),h=e.n(o),D=e(4352),l=e(59225),s=e(73835),P=e(41601),c=e(35316),B=e(9734),ee=e(7098),p=e(48388),A=e(11527),F=function(k){var b=k.subscription,Ee=k.handleCancel,ae=k.visible,le=k.data,ce=k.logUrl,t=(0,o.useState)("\u542F\u52A8\u4E2D..."),G=r()(t,2),ve=G[0],re=G[1],Ce=(0,o.useState)(!0),_e=r()(Ce,2),J=_e[0],y=_e[1],z=(0,o.useState)(!0),X=r()(z,2),Q=X[0],ge=X[1],Z=(0,o.useState)(!1),fe=r()(Z,2),he=fe[0],a=fe[1],V=function g(K){K&&y(!0),s.W.get(ce||"".concat(P.Z.apiPrefix,"subscriptions/").concat(b.id,"/log")).then(function(Y){var me=Y.code,oe=Y.data;if(me===200&&localStorage.getItem("logSubscription")===String(b.id)){var C=oe;re(C||"\u6682\u65E0\u65E5\u5FD7"),ge(C&&!(0,p.x$)(C)),C&&!(0,p.x$)(C)&&setTimeout(function(){g()},2e3)}}).finally(function(){K&&y(!1)})},ie=function(){localStorage.removeItem("logSubscription"),Ee()},pe=function(){return(0,A.jsxs)(A.Fragment,{children:[(Q||J)&&(0,A.jsx)(c.Z,{spin:!0}),!Q&&!J&&(0,A.jsx)(B.Z,{}),(0,A.jsx)("span",{style:{marginLeft:5},children:b&&b.name})]})};return(0,o.useEffect)(function(){b&&b.id&&ae&&V(!0)},[b,ae]),(0,o.useEffect)(function(){le&&re(le)},[le]),(0,o.useEffect)(function(){a(document.body.clientWidth<768)},[]),(0,A.jsx)(D.Z,{title:pe(),open:ae,centered:!0,className:"log-modal",bodyStyle:{minHeight:"300px"},forceRender:!0,onOk:function(){return ie()},onCancel:function(){return ie()},footer:[(0,A.jsx)(l.Z,{type:"primary",onClick:function(){return ie()},children:"\u77E5\u9053\u4E86"})],children:J?(0,A.jsx)(ee.Z,{}):(0,A.jsx)("pre",{style:he?{fontFamily:"Source Code Pro",width:375,zoom:.83}:{},children:ve})})};f.default=F},62531:function(v,f,e){"use strict";e.r(f);var d=e(35290),r=e.n(d),o=e(30279),h=e.n(o),D=e(411),l=e.n(D),s=e(46686),P=e.n(s),c=e(63313),B=e.n(c),ee=e(61839),p=e(71976),A=e(63533),F=e(30314),De=e(50499),k=e(4352),b=e(28666),Ee=e(73835),ae=e(41601),le=e(73183),ce=e.n(le),t=e(11527),G=ee.Z.Option,ve=/[^\/\:]+\/[^\/]+(?=\.git)/,re=/[^\/\:]+\/[^\/]+$/,Ce=function(J){var y=J.subscription,z=J.handleCancel,X=J.visible,Q=p.Z.useForm(),ge=P()(Q,1),Z=ge[0],fe=(0,c.useState)(!1),he=P()(fe,2),a=he[0],V=he[1],ie=(0,c.useState)("public-repo"),pe=P()(ie,2),g=pe[0],K=pe[1],Y=(0,c.useState)("crontab"),me=P()(Y,2),oe=me[0],C=me[1],xe=(0,c.useState)("ssh-key"),Be=P()(xe,2),Oe=Be[0],te=Be[1],Te=function(){var j=l()(r()().mark(function i(x){var E,I,L,$,N;return r()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return V(!0),E=y?"put":"post",I=h()({},x),y&&(I.id=y.id),M.prev=4,M.next=7,Ee.W[E]("".concat(ae.Z.apiPrefix,"subscriptions"),{data:I});case 7:L=M.sent,$=L.code,N=L.data,$===200&&(A.ZP.success(y?"\u66F4\u65B0\u8BA2\u9605\u6210\u529F":"\u65B0\u5EFA\u8BA2\u9605\u6210\u529F"),z(N)),V(!1),M.next=17;break;case 14:M.prev=14,M.t0=M.catch(4),V(!1);case 17:case"end":return M.stop()}},i,null,[[4,14]])}));return function(x){return j.apply(this,arguments)}}(),Ie=function(i){K(i.target.value);var x=Z.getFieldValue("url"),E=Z.getFieldValue("branch");Z.setFieldsValue({alias:se(x,E,i.target.value)}),x&&Z.validateFields(["url"])},Pe=function(i){C(i.target.value),Z.setFieldsValue({schedule:""})},W=function(i){te(i.target.value)},H=function(i){var x=Z.getFieldValue("branch");Z.setFieldsValue({alias:se(i.target.value,x)})},Se=function(i){var x=Z.getFieldValue("url");Z.setFieldsValue({alias:se(x,i.target.value)})},se=function(i,x){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g,I="",L=E==="file"?re:ve;return L.test(i)&&(I=i.match(L)[0].replaceAll("/","_").replaceAll(".","_")),x&&(I=I+"_"+x),I},be=function(i){var x=i.value,E=i.onChange,I=(0,c.useState)("days"),L=P()(I,2),$=L[0],N=L[1],de=(0,c.useState)(),M=P()(de,2),ne=M[0],ue=M[1],Fe=function(q){N(q),ne&&ne>0&&(E==null||E({type:q,value:ne}))},Ze=function(q){ue(q),q?E==null||E({type:$,value:q}):E==null||E(null)};return(0,c.useEffect)(function(){x&&(N(x.type),ue(x.value))},[x]),(0,t.jsxs)(F.Z.Group,{compact:!0,children:[(0,t.jsx)(De.Z,{addonBefore:"\u6BCF",precision:0,min:1,value:ne,style:{width:"calc(100% - 58px)"},onChange:Ze}),(0,t.jsxs)(ee.Z,{value:$,onChange:Fe,children:[(0,t.jsx)(G,{value:"days",children:"\u5929"}),(0,t.jsx)(G,{value:"hours",children:"\u65F6"}),(0,t.jsx)(G,{value:"minutes",children:"\u5206"}),(0,t.jsx)(G,{value:"seconds",children:"\u79D2"})]})]})},Ae=function(i){var x=i.value,E=i.onChange,I=i.type;return I==="ssh-key"?(0,t.jsx)(p.Z.Item,{name:["pull_option","private_key"],label:"\u79C1\u94A5",rules:[{required:!0}],children:(0,t.jsx)(F.Z.TextArea,{rows:4,autoSize:{minRows:1,maxRows:6},placeholder:"\u8BF7\u8F93\u5165\u79C1\u94A5"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Z.Item,{name:["pull_option","username"],label:"\u7528\u6237\u540D",rules:[{required:!0}],children:(0,t.jsx)(F.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BA4\u8BC1\u7528\u6237\u540D"})}),(0,t.jsx)(p.Z.Item,{name:["pull_option","password"],tooltip:"Github\u5DF2\u4E0D\u652F\u6301\u5BC6\u7801\u8BA4\u8BC1\uFF0C\u8BF7\u4F7F\u7528Token\u65B9\u5F0F",label:"\u5BC6\u7801/Token",rules:[{required:!0}],children:(0,t.jsx)(F.Z,{placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801\u6216\u8005Token"})})]})},ye=(0,c.useCallback)(function(j){var i=j.clipboardData.getData("text");if(i.startsWith("ql ")){var x=i.split(" ").map(function(Fe){return Fe.trim().replace(/\"/g,"").replace(/\'/,"")}),E=P()(x,8),I=E[1],L=E[2],$=E[3],N=E[4],de=E[5],M=E[6],ne=E[7],ue=I==="raw"?"file":L.startsWith("http")?"public-repo":"private-repo";Z.setFieldsValue({type:ue,url:L,whitelist:$,blacklist:N,dependences:de,branch:M,extensions:ne,alias:se(L,M)}),K(ue)}},[]),je=(0,c.useCallback)(function(j){var i=j.clipboardData.getData("text");i.startsWith("ql ")&&j.preventDefault()},[]);return(0,c.useEffect)(function(){X?window.addEventListener("paste",ye):window.removeEventListener("paste",ye)},[X]),(0,c.useEffect)(function(){Z.setFieldsValue(y||{}),K(y&&y.type||"public-repo"),C(y&&y.schedule_type||"crontab"),te(y&&y.pull_type||"ssh-key"),y||Z.resetFields()},[y,X]),(0,t.jsx)(k.Z,{title:y?"\u7F16\u8F91\u8BA2\u9605":"\u65B0\u5EFA\u8BA2\u9605",open:X,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){Z.validateFields().then(function(i){Te(i)}).catch(function(i){console.log("Validate Failed:",i)})},onCancel:function(){return z()},confirmLoading:a,children:(0,t.jsxs)(p.Z,{form:Z,name:"form_in_modal",layout:"vertical",children:[(0,t.jsx)(p.Z.Item,{name:"name",label:"\u540D\u79F0",children:(0,t.jsx)(F.Z,{placeholder:"\u652F\u6301\u62F7\u8D1Dql repo/raw\u547D\u4EE4\uFF0C\u7C98\u8D34\u5BFC\u5165",onPaste:je})}),(0,t.jsx)(p.Z.Item,{name:"type",label:"\u7C7B\u578B",rules:[{required:!0}],initialValue:"public-repo",children:(0,t.jsxs)(b.ZP.Group,{onChange:Ie,children:[(0,t.jsx)(b.ZP,{value:"public-repo",children:"\u516C\u5F00\u4ED3\u5E93"}),(0,t.jsx)(b.ZP,{value:"private-repo",children:"\u79C1\u6709\u4ED3\u5E93"}),(0,t.jsx)(b.ZP,{value:"file",children:"\u5355\u6587\u4EF6"})]})}),(0,t.jsx)(p.Z.Item,{name:"url",label:"\u94FE\u63A5",rules:[{required:!0},{pattern:g==="file"?re:ve}],children:(0,t.jsx)(F.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8BA2\u9605\u94FE\u63A5",onPaste:H,onChange:H})}),g!=="file"&&(0,t.jsx)(p.Z.Item,{name:"branch",label:"\u5206\u652F",children:(0,t.jsx)(F.Z,{placeholder:"\u8BF7\u8F93\u5165\u5206\u652F",onPaste:Se,onChange:Se})}),(0,t.jsx)(p.Z.Item,{name:"alias",label:"\u552F\u4E00\u503C",rules:[{required:!0,message:""}],tooltip:"\u552F\u4E00\u503C\u7528\u4E8E\u65E5\u5FD7\u76EE\u5F55\u548C\u79C1\u94A5\u522B\u540D",children:(0,t.jsx)(F.Z,{placeholder:"\u81EA\u52A8\u751F\u6210",disabled:!0})}),g==="private-repo"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Z.Item,{name:"pull_type",label:"\u62C9\u53D6\u65B9\u5F0F",initialValue:"ssh-key",rules:[{required:!0}],children:(0,t.jsxs)(b.ZP.Group,{onChange:W,children:[(0,t.jsx)(b.ZP,{value:"ssh-key",children:"\u79C1\u94A5"}),(0,t.jsx)(b.ZP,{value:"user-pwd",children:"\u7528\u6237\u540D\u5BC6\u7801/Token"})]})}),(0,t.jsx)(Ae,{type:Oe})]}),(0,t.jsx)(p.Z.Item,{name:"schedule_type",label:"\u5B9A\u65F6\u7C7B\u578B",initialValue:"crontab",rules:[{required:!0}],children:(0,t.jsxs)(b.ZP.Group,{onChange:Pe,children:[(0,t.jsx)(b.ZP,{value:"crontab",children:"crontab"}),(0,t.jsx)(b.ZP,{value:"interval",children:"interval"})]})}),(0,t.jsx)(p.Z.Item,{name:oe==="crontab"?"schedule":"interval_schedule",label:"\u5B9A\u65F6\u89C4\u5219",rules:[{required:!0},{validator:function(i,x){return oe==="interval"||!x||ce().parseExpression(x).hasNext()?Promise.resolve():Promise.reject("Subscription\u8868\u8FBE\u5F0F\u683C\u5F0F\u6709\u8BEF")}}],children:oe==="interval"?(0,t.jsx)(be,{}):(0,t.jsx)(F.Z,{placeholder:"\u79D2(\u53EF\u9009) \u5206 \u65F6 \u5929 \u6708 \u5468"})}),g!=="file"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Z.Item,{name:"whitelist",label:"\u767D\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,t.jsx)(F.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u767D\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,t.jsx)(p.Z.Item,{name:"blacklist",label:"\u9ED1\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,t.jsx)(F.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u9ED1\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,t.jsx)(p.Z.Item,{name:"dependences",label:"\u4F9D\u8D56\u6587\u4EF6",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,t.jsx)(F.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u4F9D\u8D56\u6587\u4EF6\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,t.jsx)(p.Z.Item,{name:"extensions",label:"\u6587\u4EF6\u540E\u7F00",tooltip:"\u4ED3\u5E93\u9700\u8981\u62C9\u53D6\u7684\u6587\u4EF6\u540E\u7F00\uFF0C\u591A\u4E2A\u540E\u7F00\u7A7A\u683C\u5206\u9694\uFF0C\u9ED8\u8BA4\u4F7F\u7528\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684RepoFileExtensions",children:(0,t.jsx)(F.Z,{placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540E\u7F00"})}),(0,t.jsx)(p.Z.Item,{name:"sub_before",label:"\u6267\u884C\u524D",tooltip:"\u8FD0\u884C\u8BA2\u9605\u524D\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,t.jsx)(F.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u524D\u8981\u6267\u884C\u7684\u547D\u4EE4"})}),(0,t.jsx)(p.Z.Item,{name:"sub_after",label:"\u6267\u884C\u540E",tooltip:"\u8FD0\u884C\u8BA2\u9605\u540E\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,t.jsx)(F.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u540E\u8981\u6267\u884C\u7684\u547D\u4EE4"})})]}),(0,t.jsx)(p.Z.Item,{name:"proxy",label:"\u4EE3\u7406",tooltip:"\u516C\u5F00\u4ED3\u5E93\u652F\u6301HTTP/SOCK5\u4EE3\u7406\uFF0C\u79C1\u6709\u4ED3\u5E93\u652F\u6301SOCK5\u4EE3\u7406",children:(0,t.jsx)(F.Z,{placeholder:g==="private-repo"?"SOCK5\u4EE3\u7406\uFF0C\u4F8B\u5982 IP:PORT":"HTTP/SOCK5\u4EE3\u7406\uFF0C\u4F8B\u5982 http://127.0.0.1:1080"})})]})})};f.default=Ce},35167:function(){},13989:function(v,f,e){var d=e(33737);function r(o){if(Array.isArray(o))return d(o)}v.exports=r,v.exports.__esModule=!0,v.exports.default=v.exports},56037:function(v){function f(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}v.exports=f,v.exports.__esModule=!0,v.exports.default=v.exports},90623:function(v){function f(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}v.exports=f,v.exports.__esModule=!0,v.exports.default=v.exports},94434:function(v,f,e){var d=e(13989),r=e(56037),o=e(94945),h=e(90623);function D(l){return d(l)||r(l)||o(l)||h()}v.exports=D,v.exports.__esModule=!0,v.exports.default=v.exports}}]);
